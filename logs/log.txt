[2025-05-03 17:43:18] - logger:_log - INFO - Logger initialized. Logs will be saved to C:\alkashef\GitHub\BorAI\logs\log.txt
[2025-05-03 17:43:20] - logger:_log - WARNING - Failed to import optimum library. Using environment: C:\Users\aa186095\AppData\Local\anaconda3\envs\raven-env\python.exe
[2025-05-03 17:43:20] - logger:_log - WARNING - Python path: ['app.py', '', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\borai-env\\Scripts\\streamlit.exe', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\python311.zip', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\DLLs', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\Lib', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\Lib\\site-packages', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\Lib\\site-packages\\win32', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\Lib\\site-packages\\win32\\lib', 'C:\\Users\\aa186095\\AppData\\Local\\anaconda3\\envs\\raven-env\\Lib\\site-packages\\Pythonwin']
[2025-05-03 17:43:20] - logger:_log - WARNING - Will proceed without optimization
[2025-05-03 17:43:20] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:43:20] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:43:20] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:43:20] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:43:20] - logger:_log - INFO - Initializing database connection at app startup
[2025-05-03 17:43:20] - logger:_log - INFO - TeradataDatabase instance initialized
[2025-05-03 17:43:20] - logger:_log - INFO - Operation 'Database connection' started - Details: {'host': 'raven-env-oe7lr1dbadydeuff.env.clearscape.teradata.com', 'database': 'raven'}
[2025-05-03 17:43:24] - logger:_log - INFO - Operation 'Database connection' completed
[2025-05-03 17:43:24] - logger:_log - INFO - Operation 'Schema retrieval' started
[2025-05-03 17:43:24] - logger:_log - DEBUG - Getting sample data for table: branches
[2025-05-03 17:43:24] - logger:_log - DEBUG - Getting sample data for table: transactions
[2025-05-03 17:43:24] - logger:_log - INFO - Operation 'Schema retrieval' completed - Details: {'tables_count': 2}
[2025-05-03 17:43:24] - logger:_log - INFO - Database connection established and schema cached at startup
[2025-05-03 17:43:25] - logger:_log - INFO - Model 'code-llama-7b-instruct' loading on GPU started
[2025-05-03 17:43:25] - logger:_log - INFO - Creating new NL2SQL instance
[2025-05-03 17:43:25] - logger:_log - INFO - Initializing NL2SQL with model path: ./models/code-llama-7b-instruct
[2025-05-03 17:43:25] - logger:_log - INFO - Loading prompt template from: ./prompt.txt
[2025-05-03 17:43:25] - logger:_log - DEBUG - Prompt template loaded successfully
[2025-05-03 17:43:25] - logger:_log - DEBUG - Returning cached schema
[2025-05-03 17:43:25] - logger:_log - INFO - Database schema cached during initialization
[2025-05-03 17:43:25] - logger:_log - INFO - Loading tokenizer from: ./models/code-llama-7b-instruct
[2025-05-03 17:43:25] - logger:_log - INFO - Tokenizer loaded successfully, proceeding with model loading
[2025-05-03 17:43:25] - logger:_log - INFO - Loading model on GPU
[2025-05-03 17:43:26] - logger:write - ERROR - The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
[2025-05-03 17:43:26] - cextension:get_native_library - DEBUG - Loading bitsandbytes native library from: C:\Users\aa186095\AppData\Local\anaconda3\envs\raven-env\Lib\site-packages\bitsandbytes\libbitsandbytes_cuda126.dll
[2025-05-03 17:43:26] - logger:flush - INFO - Application started. All messages are being logged to: C:\alkashef\GitHub\BorAI\logs\log.txt
[2025-05-03 17:43:26] - logger:flush - ERROR - Loading checkpoint shards:   0%|                                                                                                                                | 0/2 [00:00<?, ?it/s]
[2025-05-03 17:43:32] - logger:flush - ERROR - Loading checkpoint shards:  50%|############################################################                                                            | 1/2 [00:06<00:06,  6.38s/it]
[2025-05-03 17:43:34] - logger:flush - ERROR - Loading checkpoint shards: 100%|########################################################################################################################| 2/2 [00:08<00:00,  3.77s/it]
[2025-05-03 17:43:34] - logger:flush - ERROR - Loading checkpoint shards: 100%|########################################################################################################################| 2/2 [00:08<00:00,  4.16s/it]
[2025-05-03 17:43:34] - logger:_log - INFO - Model loaded on GPU (optimization skipped - optimum not available)
[2025-05-03 17:43:34] - logger:_log - INFO - Performing model warmup with query: 'how many branches are in texas?'
[2025-05-03 17:43:34] - logger:_log - INFO - Processing natural language query: how many branches are in texas?...
[2025-05-03 17:43:34] - logger:_log - DEBUG - Creating prompt prefix cache
[2025-05-03 17:43:34] - logger:_log - DEBUG - Prompt prefix cache created, size: torch.Size([1, 688])
[2025-05-03 17:43:34] - logger:_log - DEBUG - Using cached prompt prefix
[2025-05-03 17:43:34] - logger:_log - INFO - Generating SQL with model
[2025-05-03 17:43:44] - logger:_log - DEBUG - Decoding model output
[2025-05-03 17:43:44] - logger:_log - DEBUG - Extracting SQL query from raw output
[2025-05-03 17:43:44] - logger:_log - DEBUG - Extracting SQL from model output
[2025-05-03 17:43:44] - logger:_log - DEBUG - Running Teradata-specific post-processing
[2025-05-03 17:43:44] - logger:_log - DEBUG - Applying Teradata post-processing to SQL query
[2025-05-03 17:43:44] - logger:_log - DEBUG - Teradata post-processing completed
[2025-05-03 17:43:44] - logger:_log - DEBUG - Successfully extracted SQL: SELECT COUNT(branch_id)
FROM raven.branches
WHERE ...
[2025-05-03 17:43:44] - logger:_log - INFO - Successfully generated SQL query: SELECT COUNT(branch_id)
FROM raven.branches
WHERE ...
[2025-05-03 17:43:44] - logger:_log - INFO - Model warmup completed in 9.99 seconds. Generated SQL: SELECT COUNT(branch_id)
FROM raven.branches
WHERE governorate = 'Texas';
[2025-05-03 17:43:44] - logger:_log - INFO - Model 'code-llama-7b-instruct' loading on GPU completed
[2025-05-03 17:44:00] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:00] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:00] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:00] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:01] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:01] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:01] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:01] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:01] - logger:_log - DEBUG - Returning cached schema
[2025-05-03 17:44:03] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:03] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:03] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:03] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:03] - logger:_log - DEBUG - Returning cached schema
[2025-05-03 17:44:03] - logger:_log - INFO - Operation 'Query execution' started - Details: {'query': 'SELECT * FROM transactions SAMPLE 5'}
[2025-05-03 17:44:05] - logger:_log - INFO - Operation 'Query execution' completed - Details: {'rows_returned': 5}
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:08] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:13] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IHDR' 16 13
[2025-05-03 17:44:21] - PngImagePlugin:call - DEBUG - STREAM b'IDAT' 41 5539
